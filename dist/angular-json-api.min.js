(function(){"use strict";var t,n,r,e,u,i,o,a,l,s={}.hasOwnProperty,p=function(t,n){function r(){this.constructor=t}for(var e in n)s.call(n,e)&&(t[e]=n[e]);return r.prototype=n.prototype,t.prototype=new r,t.__super__=n.prototype,t},c=[].indexOf||function(t){for(var n=0,r=this.length;r>n;n++)if(n in this&&this[n]===t)return n;return-1},h=[].slice;o=null,u="items must be an array and have $isArray attribute eq true",angular.module("json-api",["object-util"]).provider("jsonApi",function(){var t,n;n=null,t=null,this.idKey=function(t){return null==t?n:(n=t,this)},this.base=function(n){return null==n?t:(t=n,this)},this.$get=["jsonApiBuilder",function(r){var e,u;return u={},null!=n&&(u.idKey=n),null!=t&&(u.base=t),e=r.newClient(u)}]}).factory("jsonApiBuilder",["$http","_ou",function(t,n){var e;return o=n,e=new r({idKey:"id",http:t,base:"/"})}]),l=["meta","links","linked"],a={type:"$type",href:"$href",links:"$links"},n=function(){function t(t){null==t&&(t={}),angular.extend(this,t)}return t}(),e=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return p(n,t),n.prototype.cloneItem=function(t){var n,r,e;if(!(null!=t?t.$isArray:void 0))return angular.copy(t);n=angular.copy(t);for(r in t)e=t[r],n[r]=e;return n},n.prototype.updatePristineAttributes=function(t){return t.$pristineAttributes=this.getAttributes(t)},n.prototype.getAttributes=function(t){return o.filterKeysNot(t,/^\$/)},n.prototype.isUnchanged=function(t){return angular.equals(this.getAttributes(t),t.$pristineAttributes)},n.prototype.toJson=function(t){var n,r;return r={},n=o.mapKeys(t,{$id:this.idKey}),r[t.$type]=this.getAttributes(n),angular.toJson(r)},n.prototype.reservedMap=function(){var t;return t=angular.copy(a),t[this.idKey]="$id",t},n.prototype.fromJson=function(t){var n,r,e,u,i,a,s;e=angular.fromJson(t);for(r in e)c.call(l,r)<0&&(i=r);for(n=o.mapKeys(e[i],this.reservedMap()),u={},a=0,s=l.length;s>a;a++)r=l[a],null!=e[r]&&(u[r]=e[r]);return u.linked&&(u.linked=o.mapKeys(u.linked,this.reservedMap())),this.newItem({origin:e,type:i,root:u},n)},n.prototype.newItem=function(t,n){var r,e,u,i,o,a;switch(null==t&&(t={}),null==n&&(n={}),!1){case!Array.isArray(n):e=[],angular.copy(n,e),e.$isArray=!0;break;default:e={},angular.copy(n,e),e.$isArray=!1}for(u in t)i=t[u],e["$"+u]=i;if(e.$isArray)for(o=0,a=e.length;a>o;o++)r=e[o],r.$type=e.$type;return this.updatePristineAttributes(e),e},n.prototype.getLinked=function(t,n,r){var e,u,i,o,a,l,s;switch(!1){case null==n:if(e=null!=(a=t.$root)&&null!=(l=a.linked)?l[n]:void 0,null==e)return;switch(!1){case!r:for(i=0,o=e.length;o>i;i++)if(u=e[i],u.$id===r)return u;break;default:return e}break;default:return null!=(s=t.$root)?s.linked:void 0}},n}(n),t=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return p(n,t),n.prototype.urlFor=function(){var t,n,r,e,u,i,a,l,s,p,c;for(t=[],s=0,p=arguments.length;p>s;s++)l=arguments[s],t.push(this.cloneItem(l));if(!t[0])return""+this.base;switch(r=null,!1){case!angular.isObject(t[0]):r=t[0];break;default:r={type:t[0]}}if(i=null!=(c=t[1])?c.$type:void 0)throw new Error("unexpected second argument with $type "+i);if(t[1])switch(!1){case!angular.isObject(t[1]):r.query=t[1];break;default:r.id=t[1]}switch(a=r.url,n=r.id,i=r.type,u=r.query,null==i&&(i=r.$type),null==n&&(n=r.$id),!1){case null==a:return""+this.base+a;case!(null!=i&&null!=n):return""+this.base+i+"/"+n;case null==i:return e=""+this.base+i,r.query&&(e=""+e+"?"+o.objectToQuery(r.query)),e}},n.prototype.updateIn=function(){var t,n,r,e;return t=2<=arguments.length?h.call(arguments,0,e=arguments.length-1):(e=0,[]),n=arguments[e++],r=t.length?t.push(n)&&t:[n],this.update.apply(this,r).then(function(t){return o.replace(n,t)})},n.prototype.createIn=function(t,n){return this.create(t,n).then(function(t){return o.replace(n,t)})},n.prototype.getIn=function(){var t,n,r;return t=2<=arguments.length?h.call(arguments,0,r=arguments.length-1):(r=0,[]),n=arguments[r++],this.get.apply(this,t).then(function(t){return o.replace(n,t)})},n.prototype.canLoadMore=function(t){var n,r,e;if(!t.$isArray)throw new Error(u);return n=null!=(r=t.$root)&&null!=(e=r.meta)?e.count:void 0,null==n?!0:n?t.$root.meta.count-t.length:0},n.prototype.loadMore=function(t,n){if(null==n&&(n={}),!t.$isArray)throw new Error(u);return n=angular.isObject(n)?angular.copy(n):{limit:n},null==n.skip&&(n.skip=t.length),this.get(t,n).then(function(n){return function(r){var e,u,i,o,a,l;for(t.$root.meta=r.$root.meta,o=0,a=r.length;a>o;o++)i=r[o],t.push(i);if(e=n.getLinked(r)){!n.getLinked(t)&&e&&(t.$root.linked={}),l=[];for(u in e)n.getLinked(t)[u]||(n.getLinked(t)[u]=[]),l.push(function(){var n,e,o,a;for(o=this.getLinked(r,u),a=[],n=0,e=o.length;e>n;n++)i=o[n],a.push(this.getLinked(t)[u].push(i));return a}.call(n));return l}}}(this))},n.prototype.load=function(t){return this.get(t).then(function(n){return o.replace(t,n)})},n.prototype.update=function(){var t,n,r,e,u;return t=2<=arguments.length?h.call(arguments,0,u=arguments.length-1):(u=0,[]),n=arguments[u++],e=t.length?t:[n],r=this.urlFor.apply(this,e),this.http.put(r,this.toJson(n)).then(function(t){return function(n){return t.fromJson(n.data)}}(this))},n.prototype["delete"]=function(t){return this.http["delete"](this.urlFor({type:t.$type,id:t.$id})).then(function(){return!0})},n.prototype.create=function(t,n){return null==n&&(n={}),this.http.post(this.urlFor(t),this.toJson(n)).then(function(t){return function(n){return t.fromJson(n.data)}}(this))},n.prototype.get=function(){var t;return t=1<=arguments.length?h.call(arguments,0):[],this.http.get(this.urlFor.apply(this,t)).then(function(t){return function(n){return t.fromJson(n.data)}}(this))},n}(e),i=function(t){var n,r,e,u;n=new Function(t),r={},angular.copy(t,r);for(e in r)s.call(r,e)&&(u=r[e],n[e]=u);return n},r=function(){function n(t){null==t&&(t={}),this.defaults=angular.extend({},t)}return n.prototype.newClient=function(n){return null==n&&(n={}),n=angular.extend({},this.defaults,n),n.http=i(n.http),new t(n)},n}()}).call(this);