(function(){"use strict";var t,n,r,e,u,i,o,s,l={}.hasOwnProperty,a=function(t,n){function r(){this.constructor=t}for(var e in n)l.call(n,e)&&(t[e]=n[e]);return r.prototype=n.prototype,t.prototype=new r,t.__super__=n.prototype,t},p=[].indexOf||function(t){for(var n=0,r=this.length;r>n;n++)if(n in this&&this[n]===t)return n;return-1},c=[].slice;i=null,angular.module("json-api",["object-util"]).provider("jsonApi",function(){var t,n;n=null,t=null,this.idKey=function(t){return null==t?n:(n=t,this)},this.base=function(n){return null==n?t:(t=n,this)},this.$get=["jsonApiBuilder",function(r){var e,u;return u={},null!=n&&(u.idKey=n),null!=t&&(u.base=t),e=r.newClient(u)}]}).factory("jsonApiBuilder",["$http","_ou",function(t,n){var e;return i=n,e=new r({idKey:"id",http:t,base:"/"})}]),s=["meta","links","linked"],o={type:"$type",href:"$href",links:"$links"},n=function(){function t(t){null==t&&(t={}),angular.extend(this,t)}return t}(),e=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return a(n,t),n.prototype.updatePristineAttributes=function(t){return t.$pristineAttributes=this.getAttributes(t)},n.prototype.getAttributes=function(t){return i.filterKeysNot(t,/^\$/)},n.prototype.isUnchanged=function(t){return angular.equals(this.getAttributes(t),t.$pristineAttributes)},n.prototype.toJson=function(t){var n;return n={},n[t.$type]=this.getAttributes(t),angular.toJson(n)},n.prototype.reservedMap=function(){var t;return t=angular.copy(o),t[this.idKey]="$id",t},n.prototype.fromJson=function(t){var n,r,e,u,o,l,a;e=angular.fromJson(t);for(r in e)p.call(s,r)<0&&(o=r);for(n=i.mapKeys(e[o],this.reservedMap()),u={},l=0,a=s.length;a>l;l++)r=s[l],null!=e[r]&&(u[r]=e[r]);return u.linked&&(u.linked=i.mapKeys(u.linked,this.reservedMap())),this.newItem({origin:e,type:o,root:u},n)},n.prototype.newItem=function(t,n){var r,e,u,i,o,s;switch(null==t&&(t={}),null==n&&(n={}),!1){case!Array.isArray(n):e=[],angular.copy(n,e),e.$isArray=!0;break;default:e={},angular.copy(n,e),e.$isArray=!1}for(u in t)i=t[u],e["$"+u]=i;if(e.$isArray)for(o=0,s=e.length;s>o;o++)r=e[o],r.$type=e.$type;return this.updatePristineAttributes(e),e},n.prototype.getLinked=function(t,n,r){var e,u,i,o,s,l,a;switch(!1){case null==n:if(e=null!=(s=t.$root)&&null!=(l=s.linked)?l[n]:void 0,null==e)return;switch(!1){case!r:for(i=0,o=e.length;o>i;i++)if(u=e[i],u.$id===r)return u;break;default:return e}break;default:return null!=(a=t.$root)?a.linked:void 0}},n}(n),t=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return a(n,t),n.prototype.urlFor=function(){var t,n,r,e;switch(!1){case!angular.isObject(arguments[0]):n=arguments[0];break;case null==arguments[0]:n={type:arguments[0]},null!=arguments[1]&&(n.id=arguments[1]);break;default:n={}}if(n.$href)return n.$href;switch(e=n.url,t=n.id,r=n.type,null==e&&(e=n.$href),null==r&&(r=n.$type),null==t&&(t=n.$id),!1){case null==e:return""+this.base+e;case!(null!=r&&null!=t):return""+this.base+r+"/"+t;case null==r:return""+this.base+r}},n.prototype.updateIn=function(t){return this.update(t).then(function(n){return i.replace(t,n)})},n.prototype.createIn=function(t,n){return this.create(t,n).then(function(t){return i.replace(n,t)})},n.prototype.getIn=function(){var t,n,r;return t=2<=arguments.length?c.call(arguments,0,r=arguments.length-1):(r=0,[]),n=arguments[r++],this.get.apply(this,t).then(function(t){return i.replace(n,t)})},n.prototype.load=function(t){return this.get({id:t.$id,type:t.$type}).then(function(n){return i.replace(t,n)})},n.prototype.update=function(t){return this.http.put(this.urlFor(t),this.toJson(t)).then(function(t){return function(n){return t.fromJson(n.data)}}(this))},n.prototype["delete"]=function(t){return this.http["delete"](this.urlFor({type:t.$type,id:t.$id})).then(function(){return!0})},n.prototype.create=function(t,n){return null==n&&(n={}),this.http.post(this.urlFor(t),this.toJson(n)).then(function(t){return function(n){return t.fromJson(n.data)}}(this))},n.prototype.get=function(){var t;return t=1<=arguments.length?c.call(arguments,0):[],this.http.get(this.urlFor.apply(this,t)).then(function(t){return function(n){return t.fromJson(n.data)}}(this))},n}(e),u=function(t){var n,r,e,u;n=new Function(t),r={},angular.copy(t,r);for(e in r)l.call(r,e)&&(u=r[e],n[e]=u);return n},r=function(){function n(t){null==t&&(t={}),this.defaults=angular.extend({},t)}return n.prototype.newClient=function(n){return null==n&&(n={}),n=angular.extend({},this.defaults,n),n.http=u(n.http),new t(n)},n}()}).call(this);